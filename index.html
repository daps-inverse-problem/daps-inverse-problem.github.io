<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Improving Diffusion Inverse Problem Solving with Decoupled Noise Annealing">
  <meta name="keywords" content="Inverse Problem, Diffusion Model">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="Y6phf4VZM9HednfYy-pEi3-KtU6uqI75tPeeinWlOYs" />
  <title>Improving Diffusion Inverse Problem Solving with Decoupled Noise Annealing</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script> -->
  <!-- <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script> -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <style>
    .image-container {
        text-align: center; /* Center images */
    }
    .image-container img {
        display: inline-block;
        /* width: 45%; */
        height: auto;
        margin: 0 10px; /* Space between images */
    }
</style>
</head>
<body>




<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Improving Diffusion Inverse Problem Solving with Decoupled Noise Annealing</h1>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://zhangbingliang2019.github.io/">Bingliang Zhang</a><sup>*,1</sup>,</span>
            <span class="author-block">
              <a href="https://chuwd19.github.io">Wenda Chu</a><sup>*,1</sup>,</span>
            <span class="author-block">
              <a href="https://jberner.info/">Julius Berner</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="https://cs.stanford.edu/~chenlin/">Chenlin Meng</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="http://tensorlab.cms.caltech.edu/users/anima/">Anima Anandkumar</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://yang-song.net/">Yang Song</a><sup>3</sup>,
            </span>
          </div>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>California Institute of Technology &nbsp;&nbsp;</span>
            <span class="author-block"><sup>2</sup>NVIDIA &nbsp;&nbsp;</span>
            <span class="author-block"><sup>3</sup>Stanford University &nbsp;&nbsp;</span>
            <span class="author-block"><sup>4</sup>OpenAI </span>
          </div>
          <div
            class="is-size-6 publication-authors has-text-centered">* Equal Contribution</div>
          
            <div class="is-size-4 publication-authors">
              CVPR 2025
            </div>
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2407.01521"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2407.01521"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/zhangbingliang2019/DAPS"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="content has-text-centered">
        <img id="teaser" src="./static/images/teaser_fig.jpeg" width="90%" style="filter: blur(0.5px); transition: filter 0.3s ease;">
      </div>
      <div id="lightbox" style="
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  justify-content: center;
  align-items: center;
  z-index: 9999;">
  
  <img 
    src="./static/images/teaser_fig_large.jpeg" 
    alt="High Resolution Image" 
    style="max-width: 90%; max-height: 90%; box-shadow: 0 0 20px rgba(0,0,0,0.5); border-radius: 8px;">
  </div>


      <div class="content has-text-justified">
        <p style="margin-left: 5%; margin-right: 5%;">
          <b>Overview of Decoupled Annealing Posterior Sampling (DAPS).</b> Our method provides a flexible and effective framework for 
          solving inverse problems through a decoupled posterior sampling process. In (a)(b), we present DAPS visual results on FFHQ and ImageNet
          at a resolution of 256, and in (c), on natural images at a resolution of 768. In (d), we display DAPS results on compressed sensing multi-coil
          MRI (CS-MRI). DAPS effectively addresses nonlinear inverse problems as well as medical imaging MRI challenges. Additionally, DAPS
          can be enhanced using large-scale latent diffusion models, as shown in (c).
        </p>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          Diffusion models have recently achieved success in solving Bayesian inverse problems with learned data priors. 
          Current methods build on top of the diffusion sampling process, where each denoising step makes small modifications 
          to samples from the previous step. However, this process struggles to correct errors from earlier sampling steps,
          leading to worse performance in complicated nonlinear inverse problems, such as phase retrieval. To address this 
          challenge, we propose a new method called Decoupled Annealing Posterior Sampling (DAPS) that relies on a novel 
          noise annealing process. Specifically, we decouple consecutive steps in a diffusion sampling trajectory, allowing 
          them to vary considerably from one another while ensuring their time-marginals anneal to the true posterior as we 
          reduce noise levels. This approach enables the exploration of a larger solution space, improving the success rate 
          for accurate reconstructions. We demonstrate that DAPS significantly improves sample quality and stability across 
          multiple image restoration tasks, particularly in complicated nonlinear inverse problems. 
        </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">

    <!-- Method -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-centered">
          <img src="./static/images/method.png" width="100%">
        </div>
        <div class="content has-text-justified">
          <p>
            We propose Decoupled Annealing Posterior Sampling (DAPS) algorithm, which incorporates a pre-trained diffusion model as a prior to solve general inverse problems. 
            By iteratively sampling from the time-marginal distribution, our method creates approximate samples from the posterior distribution.
          </p>
          <br>
        </div>

        <!-- <video id="gif" autoplay muted loop playsinline width="80%">
          <source src="./static/videos/traj.mp4"
                type="video/mp4">
        </video>
        <img src="./static/images/traj-cap.png" width="58%"> -->

      </div>
    </div>
    <!--/ Method -->
  </div>
</section>


<section class="hero" id="videos">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h3 class="title is-5">Demo of how DAPS works</h3>

      <!-- <div id="results-carousel" class="carousel results-carousel"> -->
        <div class="item has-text-centered js-id-pr">
          <video poster="" id="steve" autoplay muted controls playsinline width="60%">
            <source src="./static/videos/pr.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item has-text-centered js-id-inpaint">
          <video poster="" id="chair-tp" autoplay controls muted playsinline width="60%">
            <source src="./static/videos/inpaint.mp4"
                    type="video/mp4">
          </video>
        </div>
        <!-- <div class="item has-text-centered">
          <video poster="" id="shiba" autoplay controls muted playsinline width="60%">
            <source src="./static/videos/hdr.mp4"
                    type="video/mp4">
          </video>
        </div>
         -->
        <div class="item has-text-centered">
          <video poster="" id="toby" autoplay controls muted playsinline width="60%">
            <source src="./static/videos/sr.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item has-text-centered">
          <img src="./static/images/caption.png" width="54%"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </div>
      </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Experiments. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3  has-text-centered">Experimental Results</h2>

        <!-- Synthetic. -->
        <h3 class="title is-5">2D Synthetic Data</h3>
        <div class="content has-text-justified">
          <p>
            We compare DAPS with DPS on a nonlinear inverse problem with a 2D Gaussian mixture prior. DAPS is able to sample more accurately from the posterior distribution.
          </p>
        </div>
        <div class="content has-text-centered">
          <img src="./static/images/synthetic.png" width="75%">
        </div>
        <br/>
        <!--/ Synthetic. -->

        <!-- Main. -->
        <h3 class="title is-5">Image Restoration</h3>
        <div class="content has-text-justified">
          <p>
            We evaluate DAPS with a series of inverse problems in image domain, including five linear inverse problems: (1) super-resolution, (2) Gaussian deblurring, (3) motion deblurring,
            (4) inpainting with a box mask, (5) inpainting on random pixels, and three nonlinear inverse problems: (1) phase retrieval, (2) nonlinear deblurring, (3) high dynamic range reconstruction.
            DAPS outperforms existing baselines in terms of perceptual quality (LPIPS) and peak signal-to-noise ratio (PSNR).
          </p>
        </div>
        <div class="content has-text-centered">
          <div class="content has-text-centered">
            <img src="./static/images/main_table.png" width="100%">
          </div>
        </div>
        
         <h3 class="title is-5">DAPS with Stable Diffusion</h3>
         <div class="content has-text-justified">
           <p>
             DAPS can also be applied to large-scale text-conditioned latent diffusion models, e.g., Stable Diffusion.
           </p>
         </div>
         <div class="content has-text-centered">
           <div class="content has-text-centered">
             <img src="./static/images/sd-qual.png" width="90%">
           </div>
           <div class="content has-text-justified">
            <b>Sampling results of LatentDAPS (SD v1.5) on FFHQ 256x256 images.</b> The images are sampled with a guidance scale of 7.5 and a text prompt "a natural looking human face." 
           </div>
         </div>
 
        <!--/ Main. -->

         <!-- MRI -->
        <h3 class="title is-5">Compressed Sensing MRI</h3>
        <div class="content has-text-justified">
          <p>
            We apply DAPS to solve the compressed sensing multi-coil magnetic resonance imaging problem (CS-MRI).
          </p>
        </div>
        <div class="content has-text-centered">
          <div class="content has-text-centered">
            <div class="image-container">
              <!-- <img src="image1.jpg" alt="Image 1"> -->
              <img src="./static/images/mri.png" width="40%">
              <img src="./static/images/mri-qual.png" width="50%">
              <!-- <img src="image2.jpg" alt="Image 2"> -->
            </div>
            <!-- <img src="./static/images/mri.png" width="50%"> -->
          </div>
        </div>
        <!--/ MRI -->


        <!-- Sample diversity -->
        <h3 class="title is-5">Sample Diversity</h3>
        <div class="content has-text-justified">
          <p>
            DAPS is able to generate diverse samples given less information. For example, we show several generated samples for (1) inpainting with large boxes and (2) 16x super-resolution.
          </p>
        </div>
        <div class="content has-text-centered">
          <div class="content has-text-centered">
            <div class="image-container">
            <img src="./static/images/diverse_inpaint.png" width="45%">
            <img src="./static/images/diverse_sr.png" width="45%">
            </div>
          </div>
        </div>
        <!--/ Sample diversity. -->
        

        <h3 class="title is-5">Time Efficiency</h3>
        <div class="content has-text-justified">
          <p>
          We run DAPS with various configurations to test its performance under different computing budgets in terms of the number of
          function evaluation (NFEs). DAPS is able to generate high-quality samples with a modest time cost.
          </p>
        </div>
        <div class="content has-text-centered">
          <div class="content has-text-centered">
            <img src="./static/images/efficiency.png" width="90%">
          </div>
        </div>


      </div>
    </div>
    <!--/ Experiment. -->


</section>

<section class="section" id="Acknowledgement">
  <div class="container is-max-desktop content">
    <h2 class="title has-text-centered">Acknowledgements</h2>
    <p>
      We are grateful to Pika for providing the computing resources essential for this research. We also
      extend our thanks to the Kortschak Scholars Fellowship for supporting B.Z. and W.C. at Caltech. J.B.
      acknowledges support from the Wally Baer and Jeri Weiss Postdoctoral Fellowship. A.A. is supported
      in part by Bren endowed chair and by the AI2050 senior fellow program at Schmidt Sciences.
    </p>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title has-text-centered">BibTeX</h2>
    <pre><code>@misc{zhang2024improvingdiffusioninverseproblem,
      title={Improving Diffusion Inverse Problem Solving with Decoupled Noise Annealing}, 
      author={Bingliang Zhang and Wenda Chu and Julius Berner and Chenlin Meng and Anima Anandkumar and Yang Song},
      year={2024},
      eprint={2407.01521},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2407.01521}, 
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is adapted from <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a> and 
            licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<script>
  const img = document.getElementById('teaser');
  const highRes = new Image();
  highRes.src = 'static/images/teaser_fig_large.jpeg';

  highRes.onload = () => {
    img.src = highRes.src;
    img.style.filter = 'blur(0)';
  };
</script>

<script>
  const thumbnail = document.getElementById('teaser');
  const lightbox = document.getElementById('lightbox');

  // Show high-res image
  thumbnail.onclick = () => {
    lightbox.style.display = 'flex';
  };

  // Close lightbox on click
  lightbox.onclick = () => {
    lightbox.style.display = 'none';
  };
</script>

<script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=ffffff&w=0&t=n&d=Le8ezOdnfox42ctbC31_71e6HxywKxc1MkYUjrXLRqc'></script>
</body>
</html>
